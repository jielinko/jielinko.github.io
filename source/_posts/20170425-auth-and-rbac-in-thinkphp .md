---
title: ThinkPHP的常用的两种权限控制:Auth和Rbac
date: 2017-04-25 11:31:49
categories: # 这里写的分类会自动汇集到 categories 页面上，分类可以多级
 - web开发
tags: # 这里写的标签会自动汇集到 tags 页面上
 - php
 - 后端开发
 - thinkPHP 
 - RBAC
 - Auth   
---

# ThinkPHP的常用的两种权限控制:Auth和Rbac

## 相同点:

1.两种都是基于角色权限控制   
2.都是同一个用户可属于多个角色或用户组

## 不同点:

**Rbac**:

1.Rbac是基于节点控制,根据3级节点,module,controller,action,节点类似与树形结构,3级节点间相互有关联  
2.表关系:用户表->用户角色关联表->角色表->角色节点关联表->节点表  
3.根据3级节点控制,粒度到操作action,每个节点为单一的模块,控制器或操作  

**Auth**:

1.Auth是基于规则控制,定制规则和条件表达式 ,每一条规则都是独立的   
2.表关系:用户表->用户和用户组关联表->用户组表->规则表   
3.根据规则控制,可自由定制不同的规则,非常自由,同一个规则内可以定制多个不同节点(中间的关系:OR AND)   
4.可定制规则表达式,比如定制积分表达式   

<!-- more -->

## 想法和问题:
 
**Auth**:

1.Auth验证多条规则时条件表达式不起效果   
2.Auth官方例子只说一个根据积分的规则,假如我规则"Admin/Goods/goodsList,Admin/Goods/goodsDel"我能不能定义这里面的某些ID所属角色操作权限的规则表达式,而这些所属角色id是goods表里的某个字段,可能所属的角色是多个不同的角色?    
3.Auth不支持"Admin/*"泛解析,因为他每一条规则都是独立的   
4.对菜单,页面,按钮类的显示使用Auth会必Rbac更好更方便   

**Rbac**:

1.新手配置Rbac的时候经常出现 Rbac $_SESSION['_access_list'] 获取不到的问题,因为Rbac是使用ThinkPHP的底层DB引擎DSN连接数据库,需要配置数据库链接和5个表的关系,字段名和表名不能出现问题   
2.允许完成"Admin/*"类型的泛解析,比如这里直接定制一个Admin模块的节点,不要下级节点就可以了   

**通用**: 

1.不管是Rbac的角色表或者Auth里面的用户组表也好,都可以扩展,比如对角色或用户组进行多层分级   
2.Rbac的节点和Auth的规则都可以进行分级,比如前端功能权限,后端功能权限,后端某个功能模块权限等等   
3.上面两个东西都不能应用到权限管控之中去,比如Rbac不能分享上级角色权限,Auth用户组也不能,但是能更好的管理和更加流程化的操作.

参考链接：   

[ThinkPHP的常用的两种权限控制:Auth和Rbac](http://www.thinkphp.cn/topic/28710.html)
